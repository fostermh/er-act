(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{537:function(e,t,a){},538:function(e,t,a){"use strict";a.r(t);var n=a(17),o=a(6),i=a.n(o),r=a(58),s=a(69),c=a(285),l=a(105),d=a(287),u=(a(344),a(7)),p=a.n(u),h=(a(345),a(181)),b=a(43),j="UPDATE_ERDDAPINPUT",m="REQUEST_ERDDAP_DATA",f="RECEIVE_ERDDAP_DATA",x="UPDATE_FEATURE_COUNT",v="UPDATE_QUERY",g=function(e,t,a){return function(n){var o=function(e){if(console.log(e),e.features)return e}(e);n(O({url:a,name:a.pathname.match(/tabledap\/(.*)\.geoJson/)[1],data:o,attributes:t,visibile:!0}))}},O=function(e){return{type:f,results:e}},y=function(e){return Object(b.a)({type:m},e)},C={erddapInput:"",erddapResults:[],featureCount:0,isFetching:!1},E={query:""},_=Object(s.combineReducers)({isochronesControls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(b.a)(Object(b.a)({},e),{},{erddapInput:t.payload.inputValue});case m:return Object(b.a)(Object(b.a)({},e),{},{isFetching:!0});case f:return Object(b.a)(Object(b.a)({},e),{},{erddapResults:[].concat(Object(h.a)(e.erddapResults),[t.results]),isFetching:!1});case x:return Object(b.a)(Object(b.a)({},e),{},{featureCount:t.payload.featureCount});default:return e}},filters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(b.a)(Object(b.a)({},e),{},{query:t.payload.inputValue});default:return e}}}),R=a(95),I=a(96),T=a(110),w=a(108),A=a(315),L=a(129),B=(a(346),a(347),{});B.HERE=u.TileLayer.extend({options:{subdomains:"1234",minZoom:2,maxZoom:18,scheme:"normal.day",resource:"maptile",mapId:"newest",format:"png8",appId:"",appCode:""},initialize:function(e){var t=(e=u.setOptions(this,e)).scheme.split(".")[0];e.tileResolution=256,u.Browser.retina&&(e.tileResolution=512);var a="base.maps.api.here.com";"satellite"!=t&&"terrain"!=t&&"hybrid"!=t||(a="aerial.maps.api.here.com"),-1!==e.scheme.indexOf(".traffic.")&&(a="traffic.maps.api.here.com");var n="https://{s}."+a+"/{resource}/2.1/{resource}/{mapId}/{scheme}/{z}/{x}/{y}/{tileResolution}/{format}?app_id={appId}&app_code={appCode}";this._attributionUrl=u.Util.template("https://1."+a+"/maptile/2.1/copyright/{mapId}?app_id={appId}&app_code={appCode}",this.options),u.TileLayer.prototype.initialize.call(this,n,e),this._attributionText=""},onAdd:function(e){u.TileLayer.prototype.onAdd.call(this,e),this._attributionBBoxes||this._fetchAttributionBBoxes()},onRemove:function(e){u.TileLayer.prototype.onRemove.call(this,e),this._map.attributionControl.removeAttribution(this._attributionText),this._map.off("moveend zoomend resetview",this._findCopyrightBBox,this)},_fetchAttributionBBoxes:function(){var e=new XMLHttpRequest;e.onreadystatechange=u.bind((function(){4==e.readyState&&200==e.status&&this._parseAttributionBBoxes(JSON.parse(e.responseText))}),this),e.open("GET",this._attributionUrl,!0),e.send()},_parseAttributionBBoxes:function(e){if(this._map){for(var t=e[this.options.scheme.split(".")[0]]||e.normal,a=0;a<t.length;a++)if(t[a].boxes)for(var n=0;n<t[a].boxes.length;n++){var o=t[a].boxes[n];t[a].boxes[n]=u.latLngBounds([[o[0],o[1]],[o[2],o[3]]])}this._map.on("moveend zoomend resetview",this._findCopyrightBBox,this),this._attributionProviders=t,this._findCopyrightBBox()}},_findCopyrightBBox:function(){if(this._map){for(var e=this._attributionProviders,t=[],a=this._map.getZoom(),n=this._map.getBounds(),o=0;o<e.length;o++){if(e[o].minLevel<a&&e[o].maxLevel>a&&!e[o].boxes){t.push(e[o]);break}for(var i=0;i<e[o].boxes.length;i++){var r=e[o].boxes[i];if(n.overlaps(r)){t.push(e[o]);break}}}var s=['<a href="https://legal.here.com/terms/serviceterms/gb/">HERE maps</a>'];for(o=0;o<t.length;o++){var c=t[o];s.push('<abbr title="'+c.alt+'">'+c.label+"</abbr>")}var l="\xa9 "+s.join(", ")+". ";l!==this._attributionText&&(this._map.attributionControl.removeAttribution(this._attributionText),this._map.attributionControl.addAttribution(this._attributionText=l))}}}),B.here=function(e){return new B.HERE(e)};var D=B;p.a.HexbinLayer.prototype.onRemove=function(e){p.a.SVG.prototype.onRemove.call(this),this._destroyContainer(),e.off({moveend:this.redraw},this),this._map=null,L.select(this._container).remove()};var H={width:"100%",height:"100vh"},U=D.here({appId:"yATlKFDZwdLtjHzyTeCK",appCode:"0XXQyxbiCjVU7jN2URXuhg",scheme:"reduced.day"}),k=A.a("Oceans"),z=p.a.featureGroup(),V=p.a.markerClusterGroup(),P=(p.a.featureGroup(),p.a.heatLayer()),S={radius:18,opacity:.3,duration:200,colorScaleExtent:[1,void 0],radiusScaleExtent:[1,void 0],colorDomain:null,radiusDomain:null,colorRange:["#f7fbff","#08306b"],radiusRange:[5,18],pointerEvents:"all"},N=p.a.hexbinLayer(S).hoverHandler(p.a.HexbinHoverHandler.tooltip()),F=L.scaleLog().range(["white","#ffecb3","#e85285","#6a1b9a"]).interpolate(L.interpolateLab);N.colorScale(F);var q=p.a.latLng(-90,-280),G=p.a.latLng(90,280),J={center:[50,-140.729687],zoomControl:!1,maxBounds:p.a.latLngBounds(q,G),maxZoom:20,zoom:3,layers:[V,U]},Q=function(e){Object(T.a)(a,e);var t=Object(w.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"componentDidMount",value:function(){this.map=p.a.map("map",J),this.map.createPane("isochronesPane").style.opacity=.9;var e={"HERE reduced.day":U,"esri Oceans":k},t={Points:z,"Point Cluster":V,"Hex Bin":N,"Heat Map":P};p.a.control.layers(e).addTo(this.map),p.a.control.layers(t).addTo(this.map),p.a.control.zoom({position:"topright"}).addTo(this.map)}},{key:"addErddap",value:function(e){var t=this.props.isochronesControls.erddapResults,a=this.map,n=p.a.divIcon({className:"my-div-icon",iconSize:8}),o=[],i=[],r=[],s=0;t.forEach((function(e){if(e.visibile){var t=e.data;r=p.a.geoJSON(t.features,{pointToLayer:function(e,t){return p.a.marker(t,{icon:n})},onEachFeature:function(e,t){o.push(e.geometry.coordinates),i.push([e.geometry.coordinates[1],e.geometry.coordinates[0]])},filter:function(e,t){return a.getBounds().contains(p.a.GeoJSON.coordsToLatLngs([e.geometry.coordinates]))}}),s+=o.length,r.addTo(V),N.data(o),P?P.setLatLngs(i):console.log("heatLayer is null: "+P),o.length+z.getLayers().length<1001?r.addTo(z):z.clearLayers()}}));var c=this.props,l=c.dispatch,d=c.featureCount;s>0&&s!=d&&(console.log("fcount: "+s+" fc: "+d),l({type:x,payload:{featureCount:s}}))}},{key:"componentDidUpdate",value:function(e,t){this.addErddap(e)}},{key:"render",value:function(){return Object(n.jsx)("div",{id:"map",style:H})}}]),a}(i.a.Component),Z=Object(l.b)((function(e){return{isochronesControls:e.isochronesControls,featureCount:e.isochronesControls.featureCount}}))(Q),M=a(91),W=a(223),X=a.n(W),K=a(592),Y=a(540),$=a(62),ee=a(594),te=a(590),ae=a(595),ne=a(591),oe={zIndex:999,position:"absolute",width:"400px",top:"10px",left:"10px",maxHeight:"calc(100vh - 5vw)",overflow:"auto",padding:"20px"},ie={zIndex:999,position:"absolute",width:"800px",top:"10px",left:"500px",maxHeight:"calc(100vh - 5vw)",overflow:"auto",padding:"20px",marginTop:"0"},re=function(e){Object(T.a)(a,e);var t=Object(w.a)(a);function a(e){var o;return Object(R.a)(this,a),(o=t.call(this,e)).handleInputChange=function(e){var t;(0,o.props.dispatch)((t={inputValue:e.target.value},{type:j,payload:t}))},o.handleAddErddap=function(){var e,t=o.props,a=t.dispatch,n=t.erddapInput;console.log(n),n.length>0&&a((e={inputValue:n},function(t){t(y());var a=new URL(e.inputValue),n=new URL(e.inputValue.replace(/\.geoJson\?.*$/i,".dds")),o=[];return console.log(e.inputValue),console.log(n),fetch(n).then((function(e){return e.text()})).then((function(e){console.log(e);var t=Object(h.a)(e.matchAll(/\s.* (.*);/gm));return o=t.map((function(e){return e[1]})),e})).then((function(e){return fetch(a)})).then((function(e){return e.json()})).then((function(e){return console.log(e),t(g(e,o,a))})).catch((function(e){return console.error(e)}))}))},o.handleErddapToggleVisibility=function(e){var t=o.props;t.dispatch,t.erddapResults;console.log("Toggle Vis for ",e)},o.handleErddapRemoveDataset=function(e){var t=o.props;t.dispatch,t.erddapResults;console.log("Remove Dataset ",e)},o.getErddapCommonFields=function(){var e=o.props.erddapResults,t=[];return e.forEach((function(e){t=0==t.length?e.attributes:t.filter((function(t){return e.attributes.includes(t)}))})),t=t.map((function(e){return{value:e,text:e}}))},o.getErddapURLs=function(){var e=o.props.erddapResults;if(e.length>0)return e.map((function(e){return Object(n.jsxs)(K.a.Item,{children:[Object(n.jsx)(K.a.Icon,{name:"table",size:"large",verticalAlign:"middle"}),Object(n.jsxs)(K.a.Content,{children:[Object(n.jsx)(Y.a.Group,{floated:"right",children:Object(n.jsxs)("div",{"data-tooltip":"coming soon","data-position":"top center",children:[Object(n.jsx)(Y.a,{small:!0,compact:!0,icon:!0,onClick:o.handleErddapToggleVisibility.bind(Object(M.a)(o),e.name),children:Object(n.jsx)($.a,{name:"eye"})}),Object(n.jsx)(Y.a,{small:!0,compact:!0,icon:!0,onClick:o.handleErddapToggleVisibility.bind(Object(M.a)(o),e.name),children:Object(n.jsx)($.a,{name:"filter"})}),Object(n.jsx)(Y.a,{small:!0,compact:!0,icon:!0,onClick:o.handleErddapRemoveDataset.bind(Object(M.a)(o),e.name),children:Object(n.jsx)($.a,{name:"trash alternate"})})]})}),Object(n.jsx)(K.a.Header,{as:e.name,children:e.name}),Object(n.jsx)(K.a.Description,{as:e.name})]})]})}))},o.handleQueryChange=function(e){var t=o.props.dispatch;console.log(e),t({type:v,payload:{inputValue:e}})},o.handleInputChange=o.handleInputChange.bind(Object(M.a)(o)),o}return Object(I.a)(a,[{key:"render",value:function(){var e=this.props,t=e.isFetching,a=e.erddapInput,o=e.query;return Object(n.jsxs)("div",{children:[Object(n.jsxs)(ee.a,{style:oe,children:[Object(n.jsx)("div",{children:Object(n.jsx)("span",{children:"ERDDAP"})}),Object(n.jsx)(te.a,{}),Object(n.jsxs)(ae.a,{children:[Object(n.jsxs)(ae.a.Row,{columns:2,children:[Object(n.jsx)(ae.a.Column,{width:13,children:Object(n.jsx)(ne.a,{compact:!0,loading:t,value:a,onChange:this.handleInputChange,style:{width:"100%"}})}),Object(n.jsx)(ae.a.Column,{width:3,children:Object(n.jsx)(Y.a,{icon:!0,compact:!0,onClick:this.handleAddErddap,children:Object(n.jsx)($.a,{name:"plus square",size:"large",color:"black"})})})]}),Object(n.jsx)(ae.a.Row,{columns:1,children:Object(n.jsx)(ae.a.Column,{width:16,children:Object(n.jsx)(K.a,{divided:!0,relaxed:!0,children:this.getErddapURLs()})})})]})]}),Object(n.jsxs)(ee.a,{style:ie,children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("span",{children:"Filters:"}),Object(n.jsx)("pre",{children:X.a.getQueryString(o)})]}),Object(n.jsx)(te.a,{}),Object(n.jsxs)(K.a,{children:[Object(n.jsxs)(K.a.Item,{children:[Object(n.jsx)(K.a.Icon,{name:"table",size:"large",verticalAlign:"middle"}),Object(n.jsxs)(K.a.Content,{children:[Object(n.jsx)(K.a.Header,{as:"attribute",children:"station"}),Object(n.jsx)(K.a.Description,{as:"attribute_description",children:"station"})]})]}),Object(n.jsxs)(K.a.Item,{children:[Object(n.jsx)(K.a.Icon,{name:"table",size:"large",verticalAlign:"middle"}),Object(n.jsxs)(K.a.Content,{children:[Object(n.jsx)(K.a.Header,{as:"attribute",children:"LCEWAP01"}),Object(n.jsx)(K.a.Description,{as:"attribute_description",children:"Eastward Sea Water Velocity"})]})]}),Object(n.jsxs)(K.a.Item,{children:[Object(n.jsx)(K.a.Icon,{name:"table",size:"large",verticalAlign:"middle"}),Object(n.jsxs)(K.a.Content,{children:[Object(n.jsx)(K.a.Header,{as:"attribute",children:"LCNSAP01"}),Object(n.jsx)(K.a.Description,{as:"attribute_description",children:"Northward Sea Water Velocity"})]})]})]}),Object(n.jsx)(te.a,{}),Object(n.jsx)(X.a,{fields:this.getErddapCommonFields(),operators:[{value:"is null",text:"Is Null"},{value:"is not null",text:"Is Not Null"},{value:"in",text:"In"},{value:"not in",text:"Not In"},{value:"=",text:"="},{value:"!=",text:"!="},{value:"<",text:"<"},{value:">",text:">"},{value:"<=",text:"<="},{value:">=",text:">="}],query:o,onQueryChange:this.handleQueryChange})]})]})}}]),a}(i.a.Component),se=Object(l.b)((function(e){return{erddapInput:e.isochronesControls.erddapInput,isFetching:e.isochronesControls.isFetching,erddapResults:e.isochronesControls.erddapResults,query:e.filters.query}}))(re),ce=function(e){Object(T.a)(a,e);var t=Object(w.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(I.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{children:[Object(n.jsx)(Z,{}),Object(n.jsx)(se,{})]})}}]),a}(i.a.Component),le=(a(537),[d.a]),de=Object(s.createStore)(_,Object(c.composeWithDevTools)(s.applyMiddleware.apply(void 0,le)));Object(r.render)(Object(n.jsxs)(l.a,{store:de,children:[" ",Object(n.jsx)(ce,{})]}),document.getElementById("root"))}},[[538,1,2]]]);
//# sourceMappingURL=main.4012b4e0.chunk.js.map